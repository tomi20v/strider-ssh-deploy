<h3>Configuration</h3>
<!--
<h4>User</h4>
<p>
  Specify which default user for all host to login as during SSH.
</p>
<input type="text" class="span3" name="user" ng-model="config.user" placeholder="deploy">
-->
<h4>Hosts</h4>
<p>
  Specify here which hosts to connect to during deployment.
  Ensure that the private key of your strider worker(s) exist and are authorized.
</p>
<ul class="hosts unstyled">
  <li ng-repeat="item in config.hosts">
    <i class="fa fa-remove" ng-click="removeHost($index)"></i>
    [[ item ]]
  </li>
  <li ng-hide="config.hosts.length">You must add at least one host in order to deploy!</li>
</ul>
<div class="form-inline">
  <input placeholder="deployuser@staging.example.com:22" ng-model="new_host" type="text">
  <button class="btn btn-success" ng-disabled="!new_host" ng-click="addHost()">Add</button>
  <p ng-show="error">Invalid host, host must be <b>'user@host:port'</b></p>
</div>


<br/>
<h3>Deploy</h3>
<div class="row-fluid">
  <div class="span12">
    <div class="form-group">
      <div class="btn-group">
        <div class="btn" ng-model="config.scp" ng-change="save()" btn-radio="'none'"
            ng-class="{active: config.scp=='none'}">none</div>
        <div class="btn" ng-model="config.scp" ng-change="save()" btn-radio="'pack'"
             ng-class="{active: config.scp=='pack'}">pack</div>
        <div class="btn" ng-model="config.scp" ng-change="save()" btn-radio="'custom'"
             ng-class="{active: config.scp=='custom'}">custom</div>
      </div>
    </div>
    <section ng-if="config.scp==='custom'">
      <h4>Build artifact command:</h4>
      <p>If specified, the output of this command is written to a file. Eg. you have to use <code>tar cvz - .</code></p>
      <p>The command will be run in the <code>dataDir</code> (root of your repository)</p>
      <div class="form-inline">
        <input type="text" name="customcommand" ng-model="config.customcommand" class="span10" />
        <input type="button" ng-click="save()" class="btn btn-success" style="margin-left:5px;" value="Save"/>
      </div>
    </section>
    <p class="help-text">
    <ul>
      <li ng-show="config.scp=='pack'">A tarball (sans node_modules/ and .git/) is transferred to <code>[[ paths.bundle ]]</code></li>
      <li ng-show="config.scp=='custom'">A tarball (generated by <code>custom command</code>) is written to <code>[[ paths.bundle ]]</code></li>
      <li ng-show="config.scp!=='none'">If it exists, <code>[REMOTE] [[ paths.old ]]</code> is deleted.</li>
      <li ng-show="config.scp!=='none'">If it exists, <code>[REMOTE] [[ paths.remote ]]</code> is renamed to <code>[[ paths.old ]]</code>.</li>
      <li ng-show="config.scp!=='none'">The tarball is extracted into <code>[REMOTE] [[ paths.remote ]]</code> for you automatically.</li>
      <li>Add dynamic information by using the ejs syntax: <code><%= ref.branch %></code></li>
      <li>Shell code below will execute from [[ config.user || "user" ]]'s <code>$HOME</code> directory.</li>
    </ul>
    </p>
  </div>
</div>
<div class="row-fluid">
  <div class="span12">
    <textarea ui-refresh="selectedTab" ui-codemirror="{theme: 'twilight', mode: 'shell', lineNumbers: true}" ng-model="config.script"># put your shell code here</textarea>
  </div>
</div>
<br/>
<button ng-click="save()" class="btn btn-primary">Save</button>
